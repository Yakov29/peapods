var e=globalThis,t={},o={},n=e.parcelRequire2ef1;null==n&&((n=function(e){if(e in t)return t[e].exports;if(e in o){var n=o[e];delete o[e];var a={id:e,exports:{}};return t[e]=a,n.call(a.exports,a,a.exports),a.exports}var d=Error("Cannot find module '"+e+"'");throw d.code="MODULE_NOT_FOUND",d}).register=function(e,t){o[e]=t},e.parcelRequire2ef1=n),n.register;var a=n("fmRoT");async function d(){let e=JSON.parse(localStorage.getItem("loggedInUser"));e&&(document.getElementById("profileName").textContent=e.name,document.getElementById("profileNickname").textContent=`@${e.username}`,document.getElementById("podsCount").textContent=`${e.podsCount||0} Pods`,document.getElementById("followingCount").textContent=`${e.followingCount||0} Following`,document.getElementById("followersCount").textContent=`${e.followersCount||0} Followers`)}async function s(){try{let e=(await (0,a.default).get("https://peapods-base.onrender.com/pods")).data.sort((e,t)=>new Date(t.time)-new Date(e.time)),t=document.getElementById("podsContainer");t.innerHTML="";let o=JSON.parse(localStorage.getItem("loggedInUser")).id;e.forEach(e=>{let n=document.createElement("li");n.classList.add("pod"),n.innerHTML=`
                <div class="pod__title">
                    <img class="pod__user__image" src="${e.userImage||"./images/Group 5.19.png"}" alt="User Image" style="cursor: pointer;" data-username="${e.username}">
                    <div class="pod__data">
                        <p class="pod__userdata" style="cursor: pointer;" data-username="${e.username}">${e.username}</p>
                        <p class="pod__time">${new Date(e.time).toLocaleString()}</p>
                    </div>
                </div>
                <h2 class="pod__text">${e.text}</h2>
                ${e.image?`<img class="pod__image" src="${e.image}" alt="Pod Image">`:""}
                <ul class="comments-list" id="comments-${e.id}">
                    ${e.comments?e.comments.map(t=>`
                        <li class="comment-item">
                            <p><b>${t.username}</b>: ${t.text}</p>
                            ${t.userId===o?`<button class="delete-comment-btn" data-comment-id="${t.commentId}" data-pod-id="${e.id}">Delete</button>`:""}
                        </li>
                    `).join(""):""}
                </ul>
                <input class="comment-text" id="commentText-${e.id}" placeholder="Write a comment...">
                <button class="comment-btn" data-pod-id="${e.id}">Comment</button>
            `;let a=n.querySelector(".pod__user__image"),d=n.querySelector(".pod__userdata");if(a.addEventListener("click",()=>{window.location.href=`/user.html?username=${encodeURIComponent(e.username)}`}),d.addEventListener("click",()=>{window.location.href=`/user.html?username=${encodeURIComponent(e.username)}`}),e.userId===o){let t=document.createElement("button");t.textContent="Delete Pod",t.classList.add("delete-pod-button"),t.addEventListener("click",()=>{r(e.id)}),n.appendChild(t)}t.appendChild(n)}),function(){let e=document.querySelectorAll(".comment-btn"),t=document.querySelectorAll(".delete-comment-btn");e.forEach(e=>{e.addEventListener("click",async()=>{let t=e.getAttribute("data-pod-id"),o=document.getElementById(`commentText-${t}`).value;o.trim()&&await l(t,o)})}),t.forEach(e=>{e.addEventListener("click",async()=>{let t=e.getAttribute("data-pod-id"),o=e.getAttribute("data-comment-id");await i(t,o)})})}()}catch(e){console.error("Error fetching pods:",e)}}async function r(e){try{let t=(await (0,a.default).get(`https://peapods-base.onrender.com/pods/${e}`)).data;await (0,a.default).delete(`https://peapods-base.onrender.com/pods/${e}`),await c(t.username),s()}catch(e){console.error("Error deleting pod:",e)}}async function c(e){try{let t=(await (0,a.default).get("https://peapods-base.onrender.com/accounts")).data.find(t=>t.username===e);t&&(t.podsCount=(t.podsCount||0)-1,await (0,a.default).put(`https://peapods-base.onrender.com/accounts/${t.id}`,t))}catch(e){console.error("Error updating profile pod count on delete:",e)}}async function l(e,t){try{let o=JSON.parse(localStorage.getItem("loggedInUser")),n=(await (0,a.default).get(`https://peapods-base.onrender.com/pods/${e}`)).data,d={commentId:Date.now(),userId:o.id,username:o.username,text:t};n.comments=n.comments||[],n.comments.push(d),await (0,a.default).put(`https://peapods-base.onrender.com/pods/${e}`,n),s()}catch(e){console.error("Error adding comment:",e)}}async function i(e,t){try{let o=(await (0,a.default).get(`https://peapods-base.onrender.com/pods/${e}`)).data;o.comments=o.comments.filter(e=>e.commentId!==parseInt(t)),await (0,a.default).put(`https://peapods-base.onrender.com/pods/${e}`,o),s()}catch(e){console.error("Error deleting comment:",e)}}const m=document.getElementById("createPodButton"),u=document.getElementById("createPodModal"),p=document.getElementById("closeModalButton"),g=document.getElementById("submitPodButton");async function f(e){try{await (0,a.default).post("https://peapods-base.onrender.com/pods",e),s(),u.classList.toggle("change__invisible"),setTimeout(()=>{u.style.display="none"},300)}catch(e){console.error("Error creating pod:",e)}}m.addEventListener("click",()=>{u.classList.toggle("change__invisible"),u.style.display="flex"}),p.addEventListener("click",()=>{u.classList.toggle("change__invisible"),setTimeout(()=>{u.style.display="none"},300)}),g.addEventListener("click",async()=>{let e=document.getElementById("podText").value,t=document.getElementById("podImageInput").files[0],o=JSON.parse(localStorage.getItem("loggedInUser")),n={text:e,username:o.username,time:new Date().toISOString(),userImage:document.querySelector(".home__avatar").src,userId:o.id};if(t){let e=new FileReader;e.onload=async function(e){n.image=e.target.result,await f(n)},e.readAsDataURL(t)}else await f(n)}),document.addEventListener("DOMContentLoaded",()=>{d(),s()});
//# sourceMappingURL=home.2090fa2d.js.map
