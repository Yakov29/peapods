var e=globalThis,t={},o={},n=e.parcelRequire2ef1;null==n&&((n=function(e){if(e in t)return t[e].exports;if(e in o){var n=o[e];delete o[e];var a={id:e,exports:{}};return t[e]=a,n.call(a.exports,a,a.exports),a.exports}var d=Error("Cannot find module '"+e+"'");throw d.code="MODULE_NOT_FOUND",d}).register=function(e,t){o[e]=t},e.parcelRequire2ef1=n),n.register;var a=n("fmRoT");async function d(){let e=JSON.parse(localStorage.getItem("loggedInUser"));if(e)try{let t=(await (0,a.default).get(`https://peapods-base.onrender.com/accounts/${e.id}`)).data;t?(document.getElementById("profileName").textContent=t.name,document.getElementById("profileNickname").textContent=`@${t.username}`):s()}catch(e){console.error("Error fetching profile:",e),s()}else window.location.href="index.html"}function s(){alert("Аккаунт видалено або виникла помилка."),localStorage.removeItem("loggedInUser"),window.location.href="index.html"}async function r(){try{let e=(await (0,a.default).get("https://peapods-base.onrender.com/pods")).data.sort((e,t)=>new Date(t.time)-new Date(e.time)),t=document.getElementById("podsContainer");t.innerHTML="";let o=JSON.parse(localStorage.getItem("loggedInUser")).id;e.forEach(e=>{let n=document.createElement("li");n.classList.add("pod"),n.innerHTML=`
                <div class="pod__title">
                    <img class="pod__user__image" src="${e.userImage||"./images/default-avatar.png"}" alt="User Image" style="cursor: pointer;" data-username="${e.username}">
                    <div class="pod__data">
                        <p class="pod__userdata" style="cursor: pointer;" data-username="${e.username}">${e.username||"Anonymous"}</p>
                        <p class="pod__time">${new Date(e.time).toLocaleString()}</p>
                    </div>
                </div>
                <h2 class="pod__text">${e.text}</h2>
                ${e.image?`<img class="pod__image" src="${e.image}" alt="Pod Image">`:""}
                <ul class="comments-list" id="comments-${e.id}">
                    ${e.comments?e.comments.map(t=>`
                        <li class="comment-item">
                            <p><b>${t.username}</b>: ${t.text}</p>
                            ${t.userId===o?`<button class="delete-comment-btn" data-comment-id="${t.commentId}" data-pod-id="${e.id}"><i class="fas fa-trash-alt"></i></button>`:""}
                        </li>
                    `).join(""):""}
                </ul>
                <input class="comment-text" id="commentText-${e.id}" placeholder="Write a comment...">
                <button class="comment-btn" data-pod-id="${e.id}"><i class="fas fa-comment"></i></button>
            `;let a=n.querySelector(".pod__user__image"),d=n.querySelector(".pod__userdata");if(a.addEventListener("click",()=>{e.username&&(window.location.href=`user.html?username=${encodeURIComponent(e.username)}`)}),d.addEventListener("click",()=>{e.username&&(window.location.href=`user.html?username=${encodeURIComponent(e.username)}`)}),e.userId===o){let t=document.createElement("button");t.classList.add("delete-pod-button"),t.innerHTML='<i class="fas fa-trash-alt"></i>',t.addEventListener("click",()=>{c(e.id)}),n.appendChild(t)}t.appendChild(n)}),function(){let e=document.querySelectorAll(".comment-btn"),t=document.querySelectorAll(".delete-comment-btn");e.forEach(e=>{e.addEventListener("click",async()=>{let t=e.getAttribute("data-pod-id"),o=document.getElementById(`commentText-${t}`).value;o.trim()&&await i(t,o)})}),t.forEach(e=>{e.addEventListener("click",async()=>{let t=e.getAttribute("data-pod-id"),o=e.getAttribute("data-comment-id");await m(t,o)})})}()}catch(e){console.error("Error fetching pods:",e)}}async function c(e){try{await (0,a.default).delete(`https://peapods-base.onrender.com/pods/${e}`),await l(e),r()}catch(e){console.error("Error deleting pod:",e)}}async function l(e){try{let t=(await (0,a.default).get("https://peapods-base.onrender.com/pods/"+e)).data,o=(await (0,a.default).get("https://peapods-base.onrender.com/accounts")).data.find(e=>e.username===t.username);o&&(o.podsCount=(o.podsCount||0)-1,await (0,a.default).put(`https://peapods-base.onrender.com/accounts/${o.id}`,o))}catch(e){console.error("Error updating profile pod count on delete:",e)}}async function i(e,t){try{let o=JSON.parse(localStorage.getItem("loggedInUser")),n=(await (0,a.default).get(`https://peapods-base.onrender.com/pods/${e}`)).data,d={commentId:Date.now(),userId:o.id,username:o.username,text:t};n.comments=n.comments||[],n.comments.push(d),await (0,a.default).put(`https://peapods-base.onrender.com/pods/${e}`,n),r()}catch(e){console.error("Error adding comment:",e)}}async function m(e,t){try{let o=(await (0,a.default).get(`https://peapods-base.onrender.com/pods/${e}`)).data;o.comments=o.comments.filter(e=>e.commentId!==parseInt(t)),await (0,a.default).put(`https://peapods-base.onrender.com/pods/${e}`,o),r()}catch(e){console.error("Error deleting comment:",e)}}const u=document.getElementById("createPodButton"),p=document.getElementById("createPodModal"),g=document.getElementById("closeModalButton"),f=document.getElementById("submitPodButton");async function h(e){let t=new FormData;return t.append("image",e),(await (0,a.default).post("https://peapods-base.onrender.com/upload",t)).data.imageUrl}async function y(e){try{let t=(await (0,a.default).get(`https://peapods-base.onrender.com/accounts/${e}`)).data;t&&(t.podsCount=(t.podsCount||0)+1,await (0,a.default).put(`https://peapods-base.onrender.com/accounts/${t.id}`,t))}catch(e){console.error("Error updating profile pod count on create:",e)}}u.addEventListener("click",()=>{p.classList.toggle("change__invisible"),p.style.display="flex"}),g.addEventListener("click",()=>{p.classList.toggle("change__invisible"),setTimeout(()=>{p.style.display="none"},300)}),f.addEventListener("click",async()=>{let e=document.getElementById("podText").value,t=document.getElementById("podImageInput").files[0],o=document.getElementById("anonymousCheckbox").checked,n=JSON.parse(localStorage.getItem("loggedInUser"));if(e.trim()){let d={userId:o?null:n.id,username:o?"Anonymous":n.username,text:e,time:Date.now(),comments:[]};if(t){let e=await h(t);d.image=e}await (0,a.default).post("https://peapods-base.onrender.com/pods",d),await y(n.id),r(),p.classList.toggle("change__invisible"),p.style.display="none"}}),document.addEventListener("DOMContentLoaded",d),document.addEventListener("DOMContentLoaded",r);const b=document.getElementById("toTopButton");window.onscroll=function(){document.body.scrollTop>100||document.documentElement.scrollTop>100?b.style.display="block":b.style.display="none"},b.addEventListener("click",()=>{window.scrollTo({top:0,behavior:"smooth"})});
//# sourceMappingURL=home.7a0624e5.js.map
