var e=globalThis,t={},n={},o=e.parcelRequire2ef1;null==o&&((o=function(e){if(e in t)return t[e].exports;if(e in n){var o=n[e];delete n[e];var a={id:e,exports:{}};return t[e]=a,o.call(a.exports,a,a.exports),a.exports}var d=Error("Cannot find module '"+e+"'");throw d.code="MODULE_NOT_FOUND",d}).register=function(e,t){n[e]=t},e.parcelRequire2ef1=o),o.register;var a=o("fmRoT");async function d(){let e=JSON.parse(localStorage.getItem("loggedInUser"));e&&(document.getElementById("profileName").textContent=e.name,document.getElementById("profileNickname").textContent=`@${e.username}`)}async function s(){try{let e=(await (0,a.default).get("https://peapods-base.onrender.com/pods")).data.sort((e,t)=>new Date(t.time)-new Date(e.time)),t=document.getElementById("podsContainer");t.innerHTML="";let n=JSON.parse(localStorage.getItem("loggedInUser")).id;e.forEach(e=>{let o=document.createElement("li");o.classList.add("pod"),o.innerHTML=`
                <div class="pod__title">
                    <img class="pod__user__image" src="${e.userImage||"./images/default-avatar.png"}" alt="User Image" style="cursor: pointer;" data-username="${e.username}">
                    <div class="pod__data">
                        <p class="pod__userdata" style="cursor: pointer;" data-username="${e.username}">${e.username||"Anonymous"}</p>
                        <p class="pod__time">${new Date(e.time).toLocaleString()}</p>
                    </div>
                </div>
                <h2 class="pod__text">${e.text}</h2>
                ${e.image?`<img class="pod__image" src="${e.image}" alt="Pod Image">`:""}
                <ul class="comments-list" id="comments-${e.id}">
                    ${e.comments?e.comments.map(t=>`
                        <li class="comment-item">
                            <p><b>${t.username}</b>: ${t.text}</p>
                            ${t.userId===n?`<button class="delete-comment-btn" data-comment-id="${t.commentId}" data-pod-id="${e.id}">Delete</button>`:""}
                        </li>
                    `).join(""):""}
                </ul>
                <input class="comment-text" id="commentText-${e.id}" placeholder="Write a comment...">
                <button class="comment-btn" data-pod-id="${e.id}">Comment</button>
            `;let a=o.querySelector(".pod__user__image"),d=o.querySelector(".pod__userdata");if(a.addEventListener("click",()=>{e.username&&(window.location.href=`/user.html?username=${encodeURIComponent(e.username)}`)}),d.addEventListener("click",()=>{e.username&&(window.location.href=`/user.html?username=${encodeURIComponent(e.username)}`)}),e.userId===n){let t=document.createElement("button");t.textContent="Delete Pod",t.classList.add("delete-pod-button"),t.addEventListener("click",()=>{r(e.id)}),o.appendChild(t)}t.appendChild(o)}),function(){let e=document.querySelectorAll(".comment-btn"),t=document.querySelectorAll(".delete-comment-btn");e.forEach(e=>{e.addEventListener("click",async()=>{let t=e.getAttribute("data-pod-id"),n=document.getElementById(`commentText-${t}`).value;n.trim()&&await l(t,n)})}),t.forEach(e=>{e.addEventListener("click",async()=>{let t=e.getAttribute("data-pod-id"),n=e.getAttribute("data-comment-id");await i(t,n)})})}()}catch(e){console.error("Error fetching pods:",e)}}async function r(e){try{await (0,a.default).delete(`https://peapods-base.onrender.com/pods/${e}`),await c(e),s()}catch(e){console.error("Error deleting pod:",e)}}async function c(e){try{let t=(await (0,a.default).get("https://peapods-base.onrender.com/pods/"+e)).data,n=(await (0,a.default).get("https://peapods-base.onrender.com/accounts")).data.find(e=>e.username===t.username);n&&(n.podsCount=(n.podsCount||0)-1,await (0,a.default).put(`https://peapods-base.onrender.com/accounts/${n.id}`,n))}catch(e){console.error("Error updating profile pod count on delete:",e)}}async function l(e,t){try{let n=JSON.parse(localStorage.getItem("loggedInUser")),o=(await (0,a.default).get(`https://peapods-base.onrender.com/pods/${e}`)).data,d={commentId:Date.now(),userId:n.id,username:n.username,text:t};o.comments=o.comments||[],o.comments.push(d),await (0,a.default).put(`https://peapods-base.onrender.com/pods/${e}`,o),s()}catch(e){console.error("Error adding comment:",e)}}async function i(e,t){try{let n=(await (0,a.default).get(`https://peapods-base.onrender.com/pods/${e}`)).data;n.comments=n.comments.filter(e=>e.commentId!==parseInt(t)),await (0,a.default).put(`https://peapods-base.onrender.com/pods/${e}`,n),s()}catch(e){console.error("Error deleting comment:",e)}}const m=document.getElementById("createPodButton"),u=document.getElementById("createPodModal"),p=document.getElementById("closeModalButton"),g=document.getElementById("submitPodButton");async function y(e){try{await (0,a.default).post("https://peapods-base.onrender.com/pods",e),s()}catch(e){console.error("Error creating pod:",e)}}m.addEventListener("click",()=>{u.classList.toggle("change__invisible"),u.style.display="flex"}),p.addEventListener("click",()=>{u.classList.toggle("change__invisible"),setTimeout(()=>{u.style.display="none"},300)}),g.addEventListener("click",async()=>{let e=document.getElementById("podText").value,t=document.getElementById("podImageInput").files[0],n=document.getElementById("anonymousCheckbox").checked,o=JSON.parse(localStorage.getItem("loggedInUser")),a=document.querySelector(".home__avatar"),d=a?a.src:null,s={text:e,time:new Date().toISOString(),userImage:n?null:d,userId:n?null:o.id,username:n?null:o.username};if(t){let e=new FileReader;e.onload=async function(e){s.image=e.target.result,await y(s)},e.readAsDataURL(t)}else await y(s);u.style.display="none"}),document.addEventListener("DOMContentLoaded",()=>{d(),s()});const f=document.querySelector(".totop"),h=document.querySelector(".updatepage");f.addEventListener("click",()=>{window.scrollTo({top:0,behavior:"smooth"})}),window.addEventListener("scroll",()=>{window.scrollY>100?f.style.display="block":f.style.display="none"}),h.addEventListener("click",()=>{d(),s()});
//# sourceMappingURL=home.5205f84d.js.map
